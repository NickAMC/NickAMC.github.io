<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Nick Climaco">
<meta name="dcterms.date" content="2024-03-24">

<title>Project: Time Series Forecasting</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="atm_forecasting_files/libs/clipboard/clipboard.min.js"></script>
<script src="atm_forecasting_files/libs/quarto-html/quarto.js"></script>
<script src="atm_forecasting_files/libs/quarto-html/popper.min.js"></script>
<script src="atm_forecasting_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="atm_forecasting_files/libs/quarto-html/anchor.min.js"></script>
<link href="atm_forecasting_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="atm_forecasting_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="atm_forecasting_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="atm_forecasting_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="atm_forecasting_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#objective" id="toc-objective" class="nav-link active" data-scroll-target="#objective">Objective:</a></li>
  <li><a href="#deliverables" id="toc-deliverables" class="nav-link" data-scroll-target="#deliverables">Deliverables:</a></li>
  <li><a href="#part-a-atm-data" id="toc-part-a-atm-data" class="nav-link" data-scroll-target="#part-a-atm-data">Part A : ATM Data</a>
  <ul class="collapse">
  <li><a href="#exploratory-data-analysis-data-cleaning" id="toc-exploratory-data-analysis-data-cleaning" class="nav-link" data-scroll-target="#exploratory-data-analysis-data-cleaning">Exploratory Data Analysis / Data Cleaning</a>
  <ul class="collapse">
  <li><a href="#atm-1" id="toc-atm-1" class="nav-link" data-scroll-target="#atm-1">ATM 1</a></li>
  <li><a href="#atm-2" id="toc-atm-2" class="nav-link" data-scroll-target="#atm-2">ATM 2</a></li>
  <li><a href="#atm-3" id="toc-atm-3" class="nav-link" data-scroll-target="#atm-3">ATM 3</a></li>
  <li><a href="#atm-4" id="toc-atm-4" class="nav-link" data-scroll-target="#atm-4">ATM 4</a></li>
  </ul></li>
  <li><a href="#model-building-and-selection" id="toc-model-building-and-selection" class="nav-link" data-scroll-target="#model-building-and-selection">Model Building and Selection</a>
  <ul class="collapse">
  <li><a href="#models-for-atm1" id="toc-models-for-atm1" class="nav-link" data-scroll-target="#models-for-atm1">Models for ATM1</a></li>
  <li><a href="#models-for-atm2" id="toc-models-for-atm2" class="nav-link" data-scroll-target="#models-for-atm2">Models for ATM2</a></li>
  <li><a href="#models-for-atm3" id="toc-models-for-atm3" class="nav-link" data-scroll-target="#models-for-atm3">Models for ATM3</a></li>
  <li><a href="#models-for-atm-4" id="toc-models-for-atm-4" class="nav-link" data-scroll-target="#models-for-atm-4">Models for ATM 4</a></li>
  </ul></li>
  <li><a href="#forecasts" id="toc-forecasts" class="nav-link" data-scroll-target="#forecasts">Forecasts</a></li>
  </ul></li>
  <li><a href="#part-b-power-data" id="toc-part-b-power-data" class="nav-link" data-scroll-target="#part-b-power-data">Part B : Power Data</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Project: Time Series Forecasting</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Nick Climaco </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 24, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="objective" class="level1">
<h1>Objective:</h1>
<p>The primary objective of this project is to develop accurate forecasts of cash withdrawals for four distinct ATM machines during the month of May 2010.</p>
</section>
<section id="deliverables" class="level1">
<h1>Deliverables:</h1>
<ul>
<li><p><u>Report</u>: documenting the data exploration findings, the rationale behind the chosen modeling techniques, the evaluation metrics employed, and a discussion of the final forecasts with accompanying visualizations.</p></li>
<li><p><u>Excel File</u>: containing the final cash withdrawal forecasts in a clear, accessible format</p></li>
</ul>
</section>
<section id="part-a-atm-data" class="level1">
<h1>Part A : ATM Data</h1>
<section id="exploratory-data-analysis-data-cleaning" class="level2">
<h2 class="anchored" data-anchor-id="exploratory-data-analysis-data-cleaning">Exploratory Data Analysis / Data Cleaning</h2>
<p>ATM data has four unique ATMs and a Cash column that represents the amount of cash taken out in the day in hundreds of dollars. For instance, ATM1 on 2009-05-01 had $9600 taken out.</p>
<div id="cell-9" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># show data</span></span>
<span id="cb1-2"><a href="#cb1-2"></a>atm_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ATM</th>
<th data-quarto-table-cell-role="th">Cash</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">DATE</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2009-05-01</td>
<td>ATM1</td>
<td>96.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2009-05-01</td>
<td>ATM2</td>
<td>107.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2009-05-02</td>
<td>ATM1</td>
<td>82.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2009-05-02</td>
<td>ATM2</td>
<td>89.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2009-05-03</td>
<td>ATM1</td>
<td>85.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2010-04-26</td>
<td>ATM4</td>
<td>403.839336</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2010-04-27</td>
<td>ATM4</td>
<td>13.697331</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2010-04-28</td>
<td>ATM4</td>
<td>348.201061</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2010-04-29</td>
<td>ATM4</td>
<td>44.245345</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2010-04-30</td>
<td>ATM4</td>
<td>482.287107</td>
</tr>
</tbody>
</table>

<p>1474 rows Ã— 2 columns</p>
</div>
</div>
</div>
<p>Our data has 1484 observations and two columns of the <code>Cash</code> amount and the <code>ATM</code>. We notice that there are missing values in our data. We have 14 missing ATMs and 19 missing cash amounts. We will do the following:</p>
<ul>
<li><p>Remove the missing ATMs since without additional information such as location, guessing which ATMs is which is not feasible.</p></li>
<li><p>Impute the missing Cash amount by ATM meaning we first groupby ATMs 1,2,3 and 4 then aggregate the mean of each subgroup. Afterwards, if that subgroup has missingness then we impute by the mean of their respectives group.</p></li>
</ul>
<p>Notice, the statistical summary of each ATMs are unique which suggest that we should treat these ATMs are independent from each other.</p>
<div id="cell-11" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a>atm_df.groupby(<span class="st">'ATM'</span>)[<span class="st">'Cash'</span>].describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">min</th>
<th data-quarto-table-cell-role="th">25%</th>
<th data-quarto-table-cell-role="th">50%</th>
<th data-quarto-table-cell-role="th">75%</th>
<th data-quarto-table-cell-role="th">max</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">ATM</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">ATM1</td>
<td>362.0</td>
<td>83.886740</td>
<td>36.656539</td>
<td>1.00000</td>
<td>73.000000</td>
<td>91.000000</td>
<td>108.000000</td>
<td>180.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ATM2</td>
<td>363.0</td>
<td>62.578512</td>
<td>38.898455</td>
<td>0.00000</td>
<td>25.500000</td>
<td>67.000000</td>
<td>93.000000</td>
<td>147.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ATM3</td>
<td>365.0</td>
<td>0.720548</td>
<td>7.944778</td>
<td>0.00000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>96.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ATM4</td>
<td>365.0</td>
<td>474.043345</td>
<td>650.935991</td>
<td>1.56326</td>
<td>124.334415</td>
<td>403.839336</td>
<td>704.507042</td>
<td>10919.761638</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-12" class="cell" data-execution_count="6">
<div class="cell-output cell-output-stdout">
<pre><code>++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
DIMENSIONS : (1474, 2)
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
COLUMNS: 

['ATM' 'Cash']
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
DATA INFO: 

ATM      object
Cash    float64
dtype: object
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
MISSING VALUES: 

ATM     14
Cash    19
dtype: int64
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
NUMBER OF UNIQUE VALUES: 

ATM       4
Cash    509
dtype: int64</code></pre>
</div>
</div>
<p>Here, we have the visualization of each ATM to better understand its patterns. ATM4 shows a farawayoutlier where we will consider removal or some imputation.</p>
<div id="cell-16" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">4</span>,<span class="dv">1</span>)</span>
<span id="cb4-2"><a href="#cb4-2"></a>ax[<span class="dv">0</span>].plot(atm1.index, atm1[<span class="st">'Cash'</span>])</span>
<span id="cb4-3"><a href="#cb4-3"></a>ax[<span class="dv">0</span>].set_title(<span class="st">'ATM 1'</span>)</span>
<span id="cb4-4"><a href="#cb4-4"></a></span>
<span id="cb4-5"><a href="#cb4-5"></a>ax[<span class="dv">1</span>].plot(atm2.index, atm2[<span class="st">'Cash'</span>])</span>
<span id="cb4-6"><a href="#cb4-6"></a>ax[<span class="dv">1</span>].set_title(<span class="st">'ATM 2'</span>)</span>
<span id="cb4-7"><a href="#cb4-7"></a></span>
<span id="cb4-8"><a href="#cb4-8"></a>ax[<span class="dv">2</span>].plot(atm3.index, atm3[<span class="st">'Cash'</span>])</span>
<span id="cb4-9"><a href="#cb4-9"></a>ax[<span class="dv">2</span>].set_title(<span class="st">'ATM 3'</span>)</span>
<span id="cb4-10"><a href="#cb4-10"></a></span>
<span id="cb4-11"><a href="#cb4-11"></a>ax[<span class="dv">3</span>].plot(atm4.index, atm4[<span class="st">'Cash'</span>])</span>
<span id="cb4-12"><a href="#cb4-12"></a>ax[<span class="dv">3</span>].set_title(<span class="st">'ATM 4'</span>)</span>
<span id="cb4-13"><a href="#cb4-13"></a></span>
<span id="cb4-14"><a href="#cb4-14"></a>plt.tight_layout()</span>
<span id="cb4-15"><a href="#cb4-15"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="atm_forecasting_files/figure-html/cell-10-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<section id="atm-1" class="level3">
<h3 class="anchored" data-anchor-id="atm-1">ATM 1</h3>
<p>ATM 1 has an average withdrawal amount $8 300 per day and the highest amount withdrawn in a day was $18 000.</p>
<p>ATM 1 peaks during the summer and winter months. For ARIMA models, ATM 1â€™s is already stationary so we will not need to difference it when building an SARIMA model. It has weekly seasonality as confirmed by the AFC plot which is indicates that a SARIMA model is appropriate to use.</p>
<div id="cell-19" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a>atm1.describe().T</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">min</th>
<th data-quarto-table-cell-role="th">25%</th>
<th data-quarto-table-cell-role="th">50%</th>
<th data-quarto-table-cell-role="th">75%</th>
<th data-quarto-table-cell-role="th">max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Cash</td>
<td>365.0</td>
<td>83.88674</td>
<td>36.505169</td>
<td>1.0</td>
<td>73.0</td>
<td>90.0</td>
<td>108.0</td>
<td>180.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-20" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a>adfuller_test(atm1.Cash)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ADF Statistic: -3.110510
p-value: 0.025785
Critical Values:
    1%: -3.449
    5%: -2.870
    10%: -2.571
Result: The series is stationary</code></pre>
</div>
</div>
<div id="cell-21" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a>sns.boxplot(data <span class="op">=</span> atm1, x <span class="op">=</span> atm1.index.month, y <span class="op">=</span> <span class="st">'Cash'</span>)</span>
<span id="cb8-2"><a href="#cb8-2"></a>plt.title(<span class="st">'ATM 1'</span>)</span>
<span id="cb8-3"><a href="#cb8-3"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="atm_forecasting_files/figure-html/cell-13-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-23" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1"></a>plot_acf(atm1[<span class="st">'Cash'</span>], lags<span class="op">=</span><span class="dv">30</span>)</span>
<span id="cb9-2"><a href="#cb9-2"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="atm_forecasting_files/figure-html/cell-15-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-24" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a>seasonal_decompose(atm1[<span class="st">'Cash'</span>], model <span class="op">=</span> <span class="st">'mul'</span>, period<span class="op">=</span><span class="dv">7</span>).plot()</span>
<span id="cb10-2"><a href="#cb10-2"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="atm_forecasting_files/figure-html/cell-16-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="atm-2" class="level3">
<h3 class="anchored" data-anchor-id="atm-2">ATM 2</h3>
<p>Here, we have an average withdrawlal of $6200 and a max of $14 700. Unlike ATM 1, ATM 2 does not have stationary data so some order of differencing is needed.</p>
<div id="cell-27" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1"></a>atm2.describe().T</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">min</th>
<th data-quarto-table-cell-role="th">25%</th>
<th data-quarto-table-cell-role="th">50%</th>
<th data-quarto-table-cell-role="th">75%</th>
<th data-quarto-table-cell-role="th">max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Cash</td>
<td>365.0</td>
<td>62.578512</td>
<td>38.791444</td>
<td>0.0</td>
<td>26.0</td>
<td>66.0</td>
<td>93.0</td>
<td>147.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-28" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1"></a>adfuller_test(atm2.Cash)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ADF Statistic: -2.588113
p-value: 0.095479
Critical Values:
    1%: -3.449
    5%: -2.870
    10%: -2.571
Result: The series is not stationary</code></pre>
</div>
</div>
<div id="cell-29" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1"></a>sns.boxplot(data <span class="op">=</span> atm2, x <span class="op">=</span> atm2.index.month, y <span class="op">=</span> <span class="st">'Cash'</span>)</span>
<span id="cb14-2"><a href="#cb14-2"></a>plt.title(<span class="st">'ATM 2'</span>)</span>
<span id="cb14-3"><a href="#cb14-3"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="atm_forecasting_files/figure-html/cell-19-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-30" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1"></a>plot_acf(atm2[<span class="st">'Cash'</span>], lags<span class="op">=</span><span class="dv">30</span>)</span>
<span id="cb15-2"><a href="#cb15-2"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="atm_forecasting_files/figure-html/cell-20-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-31" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1"></a>seasonal_decompose(atm2[<span class="st">'Cash'</span>] <span class="op">+</span> <span class="fl">0.0001</span>, model <span class="op">=</span> <span class="st">'mul'</span>, period<span class="op">=</span><span class="dv">7</span>).plot()</span>
<span id="cb16-2"><a href="#cb16-2"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="atm_forecasting_files/figure-html/cell-21-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="atm-3" class="level3">
<h3 class="anchored" data-anchor-id="atm-3">ATM 3</h3>
<p>ATM 3 recorda almost zero withdrawals from the past year. It could be due to very low traffic in its location or the machine was broken. The last three records of the data are the only non-zero values. Using the data from this ATM is not enough to use for statistical learning.</p>
<div id="cell-34" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1"></a>atm3.query(<span class="st">'Cash &gt; 0'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ATM</th>
<th data-quarto-table-cell-role="th">Cash</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">DATE</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2010-04-28</td>
<td>ATM3</td>
<td>96.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2010-04-29</td>
<td>ATM3</td>
<td>82.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2010-04-30</td>
<td>ATM3</td>
<td>85.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-35" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1"></a>atm3.describe().T</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">min</th>
<th data-quarto-table-cell-role="th">25%</th>
<th data-quarto-table-cell-role="th">50%</th>
<th data-quarto-table-cell-role="th">75%</th>
<th data-quarto-table-cell-role="th">max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Cash</td>
<td>365.0</td>
<td>0.720548</td>
<td>7.944778</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>96.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-36" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1"></a>atm3.plot()</span>
<span id="cb19-2"><a href="#cb19-2"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="atm_forecasting_files/figure-html/cell-24-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-37" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1"></a>adfuller_test(atm2.Cash)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ADF Statistic: -2.588113
p-value: 0.095479
Critical Values:
    1%: -3.449
    5%: -2.870
    10%: -2.571
Result: The series is not stationary</code></pre>
</div>
</div>
<div id="cell-38" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1"></a>sns.boxplot(data <span class="op">=</span> atm3, x <span class="op">=</span> atm3.index.month, y <span class="op">=</span> <span class="st">'Cash'</span>)</span>
<span id="cb22-2"><a href="#cb22-2"></a>plt.title(<span class="st">'ATM 3'</span>)</span>
<span id="cb22-3"><a href="#cb22-3"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="atm_forecasting_files/figure-html/cell-26-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="atm-4" class="level3">
<h3 class="anchored" data-anchor-id="atm-4">ATM 4</h3>
<p>ATM 4 has</p>
<div id="cell-41" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1"></a>atm4.plot()</span>
<span id="cb23-2"><a href="#cb23-2"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="atm_forecasting_files/figure-html/cell-27-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-42" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1"></a>atm4_filtered <span class="op">=</span> atm4[atm4.index <span class="op">!=</span> <span class="st">'2010-02-09'</span>]</span>
<span id="cb24-2"><a href="#cb24-2"></a></span>
<span id="cb24-3"><a href="#cb24-3"></a>atm4_filtered.describe().T</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">count</th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">std</th>
<th data-quarto-table-cell-role="th">min</th>
<th data-quarto-table-cell-role="th">25%</th>
<th data-quarto-table-cell-role="th">50%</th>
<th data-quarto-table-cell-role="th">75%</th>
<th data-quarto-table-cell-role="th">max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Cash</td>
<td>364.0</td>
<td>445.346317</td>
<td>351.386229</td>
<td>1.56326</td>
<td>123.917747</td>
<td>403.304865</td>
<td>704.27077</td>
<td>1712.074986</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-43" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1"></a>atm4_filtered[atm4_filtered.index.month <span class="op">==</span> <span class="dv">2</span>].<span class="bu">max</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>ATM            ATM4
Cash    1275.968167
dtype: object</code></pre>
</div>
</div>
<div id="cell-44" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1"></a><span class="co"># replace the outlier with the second highest value in the month of Feb</span></span>
<span id="cb27-2"><a href="#cb27-2"></a>atm4.loc[<span class="st">'2010-02-09'</span>,<span class="st">'Cash'</span>] <span class="op">=</span> <span class="fl">1275.968167</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-45" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1"></a>atm4.plot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="atm_forecasting_files/figure-html/cell-31-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-46" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1"></a>adfuller_test(atm4[<span class="st">'Cash'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ADF Statistic: -6.149210
p-value: 0.000000
Critical Values:
    1%: -3.449
    5%: -2.870
    10%: -2.571
Result: The series is stationary</code></pre>
</div>
</div>
<div id="cell-47" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1"></a>sns.boxplot(data <span class="op">=</span> atm4, x <span class="op">=</span> atm4.index.month, y <span class="op">=</span> <span class="st">'Cash'</span>)</span>
<span id="cb31-2"><a href="#cb31-2"></a>plt.title(<span class="st">'ATM 4'</span>)</span>
<span id="cb31-3"><a href="#cb31-3"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="atm_forecasting_files/figure-html/cell-33-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<hr>
<div id="cell-52" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1"></a><span class="im">from</span> statsmodels.tsa.seasonal <span class="im">import</span> seasonal_decompose</span>
<span id="cb32-2"><a href="#cb32-2"></a></span>
<span id="cb32-3"><a href="#cb32-3"></a>seasonal_decompose(atm1[<span class="st">'Cash'</span>], model <span class="op">=</span> <span class="st">'mul'</span>, period<span class="op">=</span><span class="dv">7</span>).plot()</span>
<span id="cb32-4"><a href="#cb32-4"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="atm_forecasting_files/figure-html/cell-34-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-53" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1"></a><span class="im">from</span> statsmodels.graphics.tsaplots <span class="im">import</span> plot_acf, plot_pacf</span>
<span id="cb33-2"><a href="#cb33-2"></a></span>
<span id="cb33-3"><a href="#cb33-3"></a>plot_acf(atm1[<span class="st">'Cash'</span>], lags<span class="op">=</span><span class="dv">30</span>)</span>
<span id="cb33-4"><a href="#cb33-4"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="atm_forecasting_files/figure-html/cell-35-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-54" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1"></a>plot_acf(atm1[<span class="st">'Cash'</span>], lags<span class="op">=</span>[<span class="dv">0</span>,<span class="dv">7</span>,<span class="dv">14</span>,<span class="dv">21</span>,<span class="dv">28</span>,<span class="dv">35</span>,<span class="dv">42</span>])</span>
<span id="cb34-2"><a href="#cb34-2"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="atm_forecasting_files/figure-html/cell-36-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="model-building-and-selection" class="level2">
<h2 class="anchored" data-anchor-id="model-building-and-selection">Model Building and Selection</h2>
<p>In this section, we will create SARIMA models and Exponential Smoothing models such as the simple exponential smoothing, Holtâ€™s Exponential and Holt-Winters models. The performance metrics we will use are RMSE, MSE, and MAE. Moreover, we use rolling window time series cross validation so that the test data is always the future values from the training set. For ATM 1,2, and 4 we will use there methods to find the best model to forecast May 2010.</p>
<p>For ATM 3, recall that out of 365 observations, only the last three values were non-zeros. Therefore, due to the lack of non-zero data we will forecast ATM3 with a Naive approach. ATM3 distribution represents a degenerate distribution which is difficult for a training model to learn from.</p>
<p>We created two functions to streamline the model building process:</p>
<pre><code> * `arima_model_evaulation` 
 * `exponential smoothing_evaluation` function </code></pre>
<p>These functions are similar where it both takes in dataset and has a default value for the train-test split of 80-20 and performs a KFold CV to find the best model for the data then reutrna dataframe for 3 models with the calculated MSE,RMSE, and MAE values.</p>
<section id="models-for-atm1" class="level3">
<h3 class="anchored" data-anchor-id="models-for-atm1">Models for ATM1</h3>
<section id="sarima-model" class="level4">
<h4 class="anchored" data-anchor-id="sarima-model">SARIMA Model</h4>
<div id="cell-62" class="cell" data-message="false" data-execution_count="39">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1"></a>sarima_evaluation_results <span class="op">=</span> arima_model_evaluation(atm1)</span>
<span id="cb36-2"><a href="#cb36-2"></a>sarima_evaluation_results</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Model</th>
<th data-quarto-table-cell-role="th">Order</th>
<th data-quarto-table-cell-role="th">Seasonal</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">AIC</th>
<th data-quarto-table-cell-role="th">BIC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>SARIMA 1</td>
<td>(2, 1, 0)</td>
<td>(5, 1, 1, 7)</td>
<td>664.919540</td>
<td>25.786034</td>
<td>18.483635</td>
<td>612.707087</td>
<td>632.276572</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>SARIMA 2</td>
<td>(4, 1, 0)</td>
<td>(4, 1, 1, 7)</td>
<td>1637.777609</td>
<td>40.469465</td>
<td>36.500786</td>
<td>1282.856539</td>
<td>1312.129076</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>SARIMA 3</td>
<td>(3, 1, 1)</td>
<td>(5, 1, 1, 7)</td>
<td>491.892295</td>
<td>22.178645</td>
<td>15.368025</td>
<td>1914.790911</td>
<td>1951.661350</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>::: {#cell-63 .cell 0=â€˜eâ€™ 1=â€˜câ€™ 2=â€˜hâ€™ 3=â€˜oâ€™ 4=â€™ â€™ 5=â€˜fâ€™ 6=â€˜aâ€™ 7=â€˜lâ€™ 8=â€˜sâ€™ 9=â€˜eâ€™ execution_count=40}</p>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1"></a><span class="co"># train test 80-20 split</span></span>
<span id="cb37-2"><a href="#cb37-2"></a></span>
<span id="cb37-3"><a href="#cb37-3"></a>n <span class="op">=</span> <span class="bu">int</span>(<span class="bu">len</span>(atm1) <span class="op">*</span> <span class="fl">0.8</span> )</span>
<span id="cb37-4"><a href="#cb37-4"></a>train, test <span class="op">=</span> atm1.iloc[:n], atm1.iloc[n:]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>:::</p>
<div id="cell-64" class="cell" data-message="false" data-execution_count="41">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1"></a><span class="co"># forecast sarima models on test</span></span>
<span id="cb38-2"><a href="#cb38-2"></a>sarima_1 <span class="op">=</span> SARIMAX(train[<span class="st">'Cash'</span>],order <span class="op">=</span> sarima_evaluation_results.Order[<span class="dv">0</span>], seasonal_order<span class="op">=</span> sarima_evaluation_results.Seasonal[<span class="dv">0</span>]).fit()</span>
<span id="cb38-3"><a href="#cb38-3"></a>forecast_sarima_1 <span class="op">=</span> sarima_1.forecast(steps<span class="op">=</span><span class="bu">len</span>(test))</span>
<span id="cb38-4"><a href="#cb38-4"></a></span>
<span id="cb38-5"><a href="#cb38-5"></a>sarima_2 <span class="op">=</span> SARIMAX(train[<span class="st">'Cash'</span>],order <span class="op">=</span> sarima_evaluation_results.Order[<span class="dv">1</span>], seasonal_order<span class="op">=</span> sarima_evaluation_results.Seasonal[<span class="dv">1</span>]).fit()</span>
<span id="cb38-6"><a href="#cb38-6"></a>forecast_sarima_2 <span class="op">=</span> sarima_2.forecast(steps<span class="op">=</span><span class="bu">len</span>(test))</span>
<span id="cb38-7"><a href="#cb38-7"></a></span>
<span id="cb38-8"><a href="#cb38-8"></a>sarima_3 <span class="op">=</span> SARIMAX(train[<span class="st">'Cash'</span>],order <span class="op">=</span> sarima_evaluation_results.Order[<span class="dv">2</span>], seasonal_order<span class="op">=</span> sarima_evaluation_results.Seasonal[<span class="dv">2</span>]).fit()</span>
<span id="cb38-9"><a href="#cb38-9"></a>forecast_sarima_3 <span class="op">=</span> sarima_3.forecast(steps<span class="op">=</span><span class="bu">len</span>(test))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-65" class="cell" data-execution_count="42">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="atm_forecasting_files/figure-html/cell-43-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="exponential-smoothing-model" class="level4">
<h4 class="anchored" data-anchor-id="exponential-smoothing-model">Exponential Smoothing Model</h4>
<div id="cell-67" class="cell" data-message="false" data-execution_count="43">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1"></a>exponential_smoothing_evaluation(atm1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Model</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MAE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Holt-Winters Model</td>
<td>895.941867</td>
<td>29.051460</td>
<td>22.192532</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Simple Exponential Smoothing</td>
<td>1399.418173</td>
<td>37.187810</td>
<td>28.825951</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Holt's Linear Trend Model</td>
<td>4113.313636</td>
<td>59.591352</td>
<td>50.296664</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-68" class="cell" data-message="false" data-execution_count="44">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1"></a><span class="co"># simple exponential smoothing</span></span>
<span id="cb40-2"><a href="#cb40-2"></a>model_simple <span class="op">=</span> SimpleExpSmoothing(train[<span class="st">'Cash'</span>]).fit(optimized <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb40-3"><a href="#cb40-3"></a>forecasts_simple <span class="op">=</span> model_simple.forecast(<span class="bu">len</span>(test))</span>
<span id="cb40-4"><a href="#cb40-4"></a></span>
<span id="cb40-5"><a href="#cb40-5"></a><span class="co"># Holt model</span></span>
<span id="cb40-6"><a href="#cb40-6"></a>model_holt <span class="op">=</span> Holt(train[<span class="st">'Cash'</span>], damped_trend<span class="op">=</span><span class="va">True</span>).fit(optimized <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb40-7"><a href="#cb40-7"></a>forecasts_holt <span class="op">=</span> model_holt.forecast(<span class="bu">len</span>(test))</span>
<span id="cb40-8"><a href="#cb40-8"></a></span>
<span id="cb40-9"><a href="#cb40-9"></a><span class="co"># Holt Winters model</span></span>
<span id="cb40-10"><a href="#cb40-10"></a>model_holt_winters <span class="op">=</span>  ExponentialSmoothing(train[<span class="st">'Cash'</span>], trend<span class="op">=</span><span class="st">'mul'</span>, seasonal<span class="op">=</span><span class="st">'mul'</span>, seasonal_periods<span class="op">=</span><span class="dv">7</span>).fit(optimized <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb40-11"><a href="#cb40-11"></a>forecasts_holt_winters <span class="op">=</span> model_holt_winters.forecast(<span class="bu">len</span>(test)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-69" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1"></a>plot_func(forecasts_simple, forecasts_holt, forecasts_holt_winters, <span class="st">'Exponential Smoothing'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="atm_forecasting_files/figure-html/cell-46-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>For ATM 1, SARIMA(3,1,1)[5,1,1,7] has the lowest error metrics</p>
</section>
</section>
<section id="models-for-atm2" class="level3">
<h3 class="anchored" data-anchor-id="models-for-atm2">Models for ATM2</h3>
<div id="cell-72" class="cell" data-message="false" data-execution_count="46">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1"></a>atm2.drop(<span class="st">'ATM'</span>, inplace<span class="op">=</span><span class="va">True</span>, axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-73" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1"></a>n <span class="op">=</span> <span class="bu">int</span>(<span class="bu">len</span>(atm2) <span class="op">*</span> <span class="fl">0.8</span> )</span>
<span id="cb43-2"><a href="#cb43-2"></a></span>
<span id="cb43-3"><a href="#cb43-3"></a>train2, test2 <span class="op">=</span> atm2.iloc[:n], atm2.iloc[n:]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-74" class="cell" data-message="false" data-execution_count="48">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1"></a>atm2_sarima <span class="op">=</span> arima_model_evaluation(atm2)</span>
<span id="cb44-2"><a href="#cb44-2"></a>atm2_sarima</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Model</th>
<th data-quarto-table-cell-role="th">Order</th>
<th data-quarto-table-cell-role="th">Seasonal</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">AIC</th>
<th data-quarto-table-cell-role="th">BIC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>SARIMA 1</td>
<td>(1, 1, 0)</td>
<td>(4, 1, 0, 7)</td>
<td>576.897519</td>
<td>24.018691</td>
<td>17.326372</td>
<td>654.157756</td>
<td>667.204079</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>SARIMA 2</td>
<td>(2, 1, 0)</td>
<td>(5, 1, 1, 7)</td>
<td>787.412224</td>
<td>28.060866</td>
<td>22.229745</td>
<td>1335.590368</td>
<td>1361.935651</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>SARIMA 3</td>
<td>(2, 1, 0)</td>
<td>(5, 1, 2, 7)</td>
<td>494.783992</td>
<td>22.243741</td>
<td>15.982527</td>
<td>1993.953925</td>
<td>2027.472507</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-75" class="cell" data-message="false" data-execution_count="49">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1"></a><span class="co"># forecast sarima models on test</span></span>
<span id="cb45-2"><a href="#cb45-2"></a>sarima_1 <span class="op">=</span> SARIMAX(train[<span class="st">'Cash'</span>],order <span class="op">=</span> atm2_sarima.Order[<span class="dv">0</span>], seasonal_order<span class="op">=</span> atm2_sarima.Seasonal[<span class="dv">0</span>]).fit()</span>
<span id="cb45-3"><a href="#cb45-3"></a>forecast_sarima_1 <span class="op">=</span> sarima_1.forecast(steps<span class="op">=</span><span class="bu">len</span>(test))</span>
<span id="cb45-4"><a href="#cb45-4"></a></span>
<span id="cb45-5"><a href="#cb45-5"></a>sarima_2 <span class="op">=</span> SARIMAX(train[<span class="st">'Cash'</span>],order <span class="op">=</span> atm2_sarima.Order[<span class="dv">1</span>], seasonal_order<span class="op">=</span> atm2_sarima.Seasonal[<span class="dv">1</span>]).fit()</span>
<span id="cb45-6"><a href="#cb45-6"></a>forecast_sarima_2 <span class="op">=</span> sarima_2.forecast(steps<span class="op">=</span><span class="bu">len</span>(test))</span>
<span id="cb45-7"><a href="#cb45-7"></a></span>
<span id="cb45-8"><a href="#cb45-8"></a>sarima_3 <span class="op">=</span> SARIMAX(train[<span class="st">'Cash'</span>],order <span class="op">=</span> atm2_sarima.Order[<span class="dv">2</span>], seasonal_order<span class="op">=</span> atm2_sarima.Seasonal[<span class="dv">2</span>]).fit()</span>
<span id="cb45-9"><a href="#cb45-9"></a>forecast_sarima_3 <span class="op">=</span> sarima_3.forecast(steps<span class="op">=</span><span class="bu">len</span>(test))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-76" class="cell" data-execution_count="50">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="atm_forecasting_files/figure-html/cell-51-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<section id="exponential-smoothing" class="level4">
<h4 class="anchored" data-anchor-id="exponential-smoothing">Exponential Smoothing</h4>
<div id="cell-78" class="cell" data-message="false" data-execution_count="51">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1"></a>atm2[<span class="st">'Cash'</span>] <span class="op">=</span> atm2[<span class="st">'Cash'</span>] <span class="op">+</span> <span class="fl">0.00001</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-79" class="cell" data-message="false" data-execution_count="52">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1"></a>exponential_smoothing_evaluation(atm2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="52">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Model</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MAE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Simple Exponential Smoothing</td>
<td>1399.765170</td>
<td>37.280527</td>
<td>30.952114</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Holt-Winters Model</td>
<td>6629.236655</td>
<td>53.926247</td>
<td>41.874426</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Holt's Linear Trend Model</td>
<td>7194.761476</td>
<td>77.956114</td>
<td>66.620276</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-81" class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1"></a>plot_func(forecasts_simple, forecasts_holt, forecasts_holt_winters, <span class="st">'Exponential Smoothing (ATM 2)'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="atm_forecasting_files/figure-html/cell-55-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="models-for-atm3" class="level3">
<h3 class="anchored" data-anchor-id="models-for-atm3">Models for ATM3</h3>
<div id="cell-83" class="cell" data-message="false" data-execution_count="55">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1"></a>atm3.drop(<span class="st">'ATM'</span>, inplace<span class="op">=</span><span class="va">True</span>, axis <span class="op">=</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-84" class="cell" data-message="false" data-execution_count="56">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1"></a>naive <span class="op">=</span> SimpleExpSmoothing(atm3[<span class="st">'Cash'</span>]).fit(optimized <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb50-2"><a href="#cb50-2"></a>forecasts_simple <span class="op">=</span> naive.forecast(<span class="dv">31</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-85" class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1"></a>fig, ax <span class="op">=</span> plt.subplots() </span>
<span id="cb51-2"><a href="#cb51-2"></a></span>
<span id="cb51-3"><a href="#cb51-3"></a>ax.plot(atm3.index, atm3[<span class="st">'Cash'</span>], label<span class="op">=</span><span class="st">'Train'</span>)  </span>
<span id="cb51-4"><a href="#cb51-4"></a>ax.plot(forecasts_simple.index, forecasts_simple, label<span class="op">=</span><span class="st">'Naive (ATM 3)'</span>) </span>
<span id="cb51-5"><a href="#cb51-5"></a></span>
<span id="cb51-6"><a href="#cb51-6"></a>ax.set_title(<span class="st">"Naive Forecast (ATM 3)"</span>)</span>
<span id="cb51-7"><a href="#cb51-7"></a>ax.set_xlabel(<span class="st">'Date'</span>)</span>
<span id="cb51-8"><a href="#cb51-8"></a>ax.set_ylabel(<span class="st">'Cash Volume'</span>)</span>
<span id="cb51-9"><a href="#cb51-9"></a>ax.grid(<span class="va">True</span>) </span>
<span id="cb51-10"><a href="#cb51-10"></a>ax.legend(loc <span class="op">=</span> <span class="st">'upper left'</span>)</span>
<span id="cb51-11"><a href="#cb51-11"></a></span>
<span id="cb51-12"><a href="#cb51-12"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="atm_forecasting_files/figure-html/cell-58-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="models-for-atm-4" class="level3">
<h3 class="anchored" data-anchor-id="models-for-atm-4">Models for ATM 4</h3>
<section id="sarima-model-1" class="level4">
<h4 class="anchored" data-anchor-id="sarima-model-1">SARIMA Model</h4>
<div id="cell-88" class="cell" data-message="false" data-execution_count="58">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1"></a>atm4.drop(<span class="st">'ATM'</span>, inplace <span class="op">=</span><span class="va">True</span>, axis <span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-89" class="cell" data-message="false" data-execution_count="59">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1"></a>atm4_arima <span class="op">=</span> arima_model_evaluation(np.log(atm4))</span>
<span id="cb53-2"><a href="#cb53-2"></a>atm4_arima</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="59">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Model</th>
<th data-quarto-table-cell-role="th">Order</th>
<th data-quarto-table-cell-role="th">Seasonal</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MAE</th>
<th data-quarto-table-cell-role="th">AIC</th>
<th data-quarto-table-cell-role="th">BIC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>SARIMA 1</td>
<td>(2, 1, 0)</td>
<td>(5, 1, 0, 7)</td>
<td>1.687952</td>
<td>1.299212</td>
<td>0.905301</td>
<td>247.424311</td>
<td>264.819409</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>SARIMA 2</td>
<td>(3, 1, 0)</td>
<td>(5, 1, 0, 7)</td>
<td>3.599405</td>
<td>1.897210</td>
<td>1.366051</td>
<td>482.766889</td>
<td>509.112172</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>SARIMA 3</td>
<td>(4, 1, 0)</td>
<td>(4, 1, 1, 7)</td>
<td>1.828468</td>
<td>1.352209</td>
<td>0.992804</td>
<td>732.365713</td>
<td>765.884294</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-91" class="cell" data-message="false" data-execution_count="61">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1"></a><span class="co"># forecast sarima models on test</span></span>
<span id="cb54-2"><a href="#cb54-2"></a>sarima_1 <span class="op">=</span> SARIMAX(train4[<span class="st">'Cash'</span>],order <span class="op">=</span> atm4_arima.Order[<span class="dv">0</span>], seasonal_order<span class="op">=</span> atm4_arima.Seasonal[<span class="dv">0</span>]).fit()</span>
<span id="cb54-3"><a href="#cb54-3"></a>forecast_sarima_1 <span class="op">=</span> sarima_1.forecast(steps<span class="op">=</span><span class="bu">len</span>(test4))</span>
<span id="cb54-4"><a href="#cb54-4"></a></span>
<span id="cb54-5"><a href="#cb54-5"></a>sarima_2 <span class="op">=</span> SARIMAX(train4[<span class="st">'Cash'</span>],order <span class="op">=</span> atm4_arima.Order[<span class="dv">1</span>], seasonal_order<span class="op">=</span> atm4_arima.Seasonal[<span class="dv">1</span>]).fit()</span>
<span id="cb54-6"><a href="#cb54-6"></a>forecast_sarima_2 <span class="op">=</span> sarima_2.forecast(steps<span class="op">=</span><span class="bu">len</span>(test4))</span>
<span id="cb54-7"><a href="#cb54-7"></a></span>
<span id="cb54-8"><a href="#cb54-8"></a>sarima_3 <span class="op">=</span> SARIMAX(train4[<span class="st">'Cash'</span>],order <span class="op">=</span> atm4_arima.Order[<span class="dv">2</span>], seasonal_order<span class="op">=</span> atm4_arima.Seasonal[<span class="dv">2</span>]).fit()</span>
<span id="cb54-9"><a href="#cb54-9"></a>forecast_sarima_3 <span class="op">=</span> sarima_3.forecast(steps<span class="op">=</span><span class="bu">len</span>(test4))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-92" class="cell" data-execution_count="62">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="atm_forecasting_files/figure-html/cell-63-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="exponential-smoothing-1" class="level4">
<h4 class="anchored" data-anchor-id="exponential-smoothing-1">Exponential Smoothing</h4>
<div id="cell-94" class="cell" data-message="false" data-execution_count="63">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1"></a>exponential_smoothing_evaluation(np.log(atm4))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="63">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Model</th>
<th data-quarto-table-cell-role="th">MSE</th>
<th data-quarto-table-cell-role="th">RMSE</th>
<th data-quarto-table-cell-role="th">MAE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Holt-Winters Model</td>
<td>1.526018</td>
<td>1.205354</td>
<td>0.893124</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Simple Exponential Smoothing</td>
<td>1.830632</td>
<td>1.340985</td>
<td>1.085312</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Holt's Linear Trend Model</td>
<td>2.563454</td>
<td>1.581905</td>
<td>1.302244</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-95" class="cell" data-message="false" data-execution_count="64">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1"></a><span class="co"># simple exponential smoothing</span></span>
<span id="cb56-2"><a href="#cb56-2"></a>model_simple <span class="op">=</span> SimpleExpSmoothing(train4[<span class="st">'Cash'</span>]).fit(optimized <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb56-3"><a href="#cb56-3"></a>forecasts_simple <span class="op">=</span> model_simple.forecast(<span class="bu">len</span>(test4))</span>
<span id="cb56-4"><a href="#cb56-4"></a></span>
<span id="cb56-5"><a href="#cb56-5"></a><span class="co"># Holt model</span></span>
<span id="cb56-6"><a href="#cb56-6"></a>model_holt <span class="op">=</span> Holt(train4[<span class="st">'Cash'</span>], exponential<span class="op">=</span><span class="va">False</span>, damped_trend<span class="op">=</span><span class="va">True</span>).fit(optimized <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb56-7"><a href="#cb56-7"></a>forecasts_holt <span class="op">=</span> model_holt.forecast(<span class="bu">len</span>(test4))</span>
<span id="cb56-8"><a href="#cb56-8"></a></span>
<span id="cb56-9"><a href="#cb56-9"></a><span class="co"># Holt Winters model</span></span>
<span id="cb56-10"><a href="#cb56-10"></a>model_holt_winters <span class="op">=</span>  ExponentialSmoothing(train4[<span class="st">'Cash'</span>] <span class="op">+</span> <span class="fl">0.0001</span>, trend<span class="op">=</span><span class="st">'mul'</span>, seasonal<span class="op">=</span><span class="st">'mul'</span>, seasonal_periods<span class="op">=</span><span class="dv">7</span>, use_boxcox<span class="op">=</span><span class="va">True</span>,freq<span class="op">=</span><span class="st">'D'</span>).fit(optimized <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb56-11"><a href="#cb56-11"></a>forecasts_holt_winters <span class="op">=</span> model_holt_winters.forecast(<span class="bu">len</span>(test4)) </span>
<span id="cb56-12"><a href="#cb56-12"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-96" class="cell" data-execution_count="65">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="atm_forecasting_files/figure-html/cell-66-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="forecasts" class="level2">
<h2 class="anchored" data-anchor-id="forecasts">Forecasts</h2>
<p>This is a great question, as it highlights the need to align your statistical analysis with real-world decision-making! Choosing between the average or maximum for cash replenishment in an ATM depends on a few factors:</p>
<ol type="1">
<li>Risk Tolerance:</li>
</ol>
<p>Risk-Averse: If minimizing the chance of running out of cash is the top priority, suggest the maximum amount forecast by your model. This provides a buffer against unexpected surges in usage. Moderate Risk: Consider a value slightly above the average forecast. This balance might be appropriate if cost-efficiency is also a concern. 2. Cost vs.&nbsp;Risk:</p>
<p>High Cost of Running Out: If running out of cash incurs significant costs (e.g., customer dissatisfaction, lost revenue, service fees), err on the side of caution by suggesting a higher value closer to the maximum. High Cost of Holding Excess Cash: If thereâ€™s a substantial cost associated with keeping extra cash in the ATM (lost opportunity cost, security concerns), a value closer to the average might be more suitable. 3. Forecasting Accuracy and Confidence Intervals:</p>
<p>Reliable Forecasts: If your model is highly accurate, and the prediction intervals are narrow, using the average forecast with a small buffer might be reasonable. Uncertain Forecasts: If prediction intervals are wide, indicating greater uncertainty, lean towards a higher value (closer to the maximum) to ensure availability. Communicating to Decision Makers:</p>
<p>Donâ€™t Just Give a Number: Explain your reasoning behind whatever value you suggest. Visualize the Forecast: Show a plot of your forecast along with potential confidence intervals. Quantify the Risk: If possible, estimate the probability of running out of cash at different suggested amounts. This makes the trade-off between risk and cost tangible. Contextualize: Help decision-makers understand the historical patterns and any upcoming events that might affect demand. Example Conversation:</p>
<p>â€œMy forecast suggests that the average daily cash withdrawal for next week is likely to be around $X. However, I recommend stocking the ATM with $Y (closer to the maximum forecast) for these reasons:</p>
<p>[Reason 1 - e.g., Thereâ€™s an upcoming event in the area that might increase demand] [Reason 2 - e.g., My model has some uncertainty, and this amount lowers our risk of running out of cash]</p>
<hr>
</section>
</section>
<section id="part-b-power-data" class="level1">
<h1>Part B : Power Data</h1>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>